!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.fetchRest=n():e.fetchRest=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function u(e){return e.toString().replace(/(^\/+|\/+$)/g,"")}function i(e){return"function"==typeof e?e():e}function a(e){var n={},t=!0,r=!1,u=void 0;try{for(var d,s=Object.entries(e)[Symbol.iterator]();!(t=(d=s.next()).done);t=!0){var c=x(d.value,2),l=c[0],f=c[1];n[l]="object"===("undefined"==typeof f?"undefined":o(f))?a(f):i(f)}}catch(m){r=!0,u=m}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw u}}return n}function d(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],r={url:e,options:n,middlewares:{}};return r.browse=g.bind(null,r),r.read=h.bind(null,r),r.edit=p.bind(null,r),r.replace=v.bind(null,r),r.add=y.bind(null,r),r.destroy=w.bind(null,r),r.addMiddleware=s.bind(null,r),r.removeMiddleware=c.bind(null,r),t.length&&t.forEach(r.addMiddleware),r}function s(e,n){n._middlewareId||(n._middlewareId=I++),e.middlewares[n._middlewareId]=n}function c(e,n){n._middlewareId&&e.middlewares[n._middlewareId]&&delete e.middlewares[n._middlewareId]}function l(e,n,t,r){var d=[];return new Promise(function(d,s){var c=u(i(e.url))+"/";n=i(n),n instanceof Array||(n=[n]),n=n.map(i).map(u).map(encodeURI).join("/"),t="object"===("undefined"==typeof t?"undefined":o(t))?"?"+encodeURI(E["default"].stringify(a(t))):"",r=b({headers:{}},a(e.options),a(r)),d({url:c,path:n,query:t,options:r})}).then(function(n){if(Object.keys(e.middlewares).length){var t=!0,r=!1,o=void 0;try{for(var u,i=Object.entries(e.middlewares)[Symbol.iterator]();!(t=(u=i.next()).done);t=!0){var a=x(u.value,2),s=a[1],c=s(n);"function"==typeof c&&d.push(c)}}catch(l){r=!0,o=l}finally{try{!t&&i["return"]&&i["return"]()}finally{if(r)throw o}}}return fetch(n.url+n.path+n.query,n.options)}).then(function(e){if(!e.ok)throw e;if(!d.length)return e;var n=Promise.resolve(e)["catch"](function(e){throw e});return d.forEach(function(e){n=n.then(e)}),n})}function f(e){if(e=i(e),e instanceof Array&&e.length%2!==0)throw new RangeError("Expected even array");return e}function m(e){if(e=i(e),e instanceof Array&&e.length%2!==1)throw new RangeError("Expected odd array");return e}function g(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return m(n)},t,b({action:"browse",method:"GET"},r))}function h(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return f(n)},t,b({action:"read",method:"GET"},r))}function p(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return f(n)},t,b({action:"edit",method:"PATCH"},r))}function v(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return f(n)},t,b({action:"replace",method:"PUT"},r))}function y(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return m(n)},t,b({action:"add",method:"POST"},r))}function w(e,n){var t=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return l(e,function(){return f(n)},t,b({action:"destroy",method:"DELETE"},r))}var b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},x=function(){function e(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(d){o=!0,u=d}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw u}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),j=t(1),E=r(j);if("function"!=typeof fetch)throw new TypeError("Fetch API required but not available");var I=23e3;e.exports={createEndpoint:d,addMiddleware:s,removeMiddleware:c,browse:g,read:h,edit:p,add:y,destroy:w}},function(e,n,t){"use strict";var r=t(2);n.extract=function(e){return e.split("?")[1]||""},n.parse=function(e){return"string"!=typeof e?{}:(e=e.trim().replace(/^(\?|#|&)/,""),e?e.split("&").reduce(function(e,n){var t=n.replace(/\+/g," ").split("="),r=t.shift(),o=t.length>0?t.join("="):void 0;return r=decodeURIComponent(r),o=void 0===o?null:decodeURIComponent(o),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]:e[r]=o,e},{}):{})},n.stringify=function(e){return e?Object.keys(e).sort().map(function(n){var t=e[n];return void 0===t?"":null===t?n:Array.isArray(t)?t.sort().map(function(e){return r(n)+"="+r(e)}).join("&"):r(n)+"="+r(t)}).filter(function(e){return e.length>0}).join("&"):""}},function(e,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}}])});